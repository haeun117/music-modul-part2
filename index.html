<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Harmony Stack – Mode Select</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-slate-50">
  <main class="max-w-4xl mx-auto p-5 space-y-5">
    <header class="space-y-2">
      <h1 class="text-2xl font-bold">Harmony Stack</h1>
      <p class="text-slate-600">학년 모드를 고르고 시작해보자.</p>
    </header>

    <section class="grid md:grid-cols-3 gap-4" id="gradeCards">
      <button data-grade="low" class="grade-card rounded-2xl border bg-white p-4 text-left shadow-sm hover:shadow">
        <div class="h-16 w-full rounded-xl bg-slate-100 flex items-end p-2">
          <div class="flex gap-1">
            <div class="h-8 w-4 rounded bg-slate-300"></div>
            <div class="h-10 w-4 rounded bg-slate-300"></div>
            <div class="h-12 w-4 rounded bg-slate-300"></div>
          </div>
        </div>
        <h2 class="mt-3 font-semibold">저학년 (초1–2)</h2>
        <ul class="mt-2 text-sm text-slate-600 space-y-1">
          <li>조작: 자동 보정</li>
          <li>개념: 느낌 중심</li>
          <li>실패: 없음</li>
        </ul>
      </button>

      <button data-grade="mid" class="grade-card rounded-2xl border bg-white p-4 text-left shadow-sm hover:shadow">
        <div class="h-16 w-full rounded-xl bg-slate-100 flex items-end p-2">
          <div class="flex gap-1">
            <div class="h-7 w-4 rounded bg-slate-300"></div>
            <div class="h-9 w-4 rounded bg-slate-300"></div>
            <div class="h-11 w-4 rounded bg-slate-300"></div>
          </div>
        </div>
        <h2 class="mt-3 font-semibold">중학년 (초3–4)</h2>
        <ul class="mt-2 text-sm text-slate-600 space-y-1">
          <li>조작: 수동 정렬</li>
          <li>개념: 어울림 구분</li>
          <li>실패: 게임오버 없음</li>
        </ul>
      </button>

      <button data-grade="high" class="grade-card rounded-2xl border bg-white p-4 text-left shadow-sm hover:shadow">
        <div class="h-16 w-full rounded-xl bg-slate-100 flex items-end p-2">
          <div class="flex gap-1">
            <div class="h-6 w-4 rounded bg-slate-300"></div>
            <div class="h-8 w-4 rounded bg-slate-300"></div>
            <div class="h-10 w-4 rounded bg-slate-300"></div>
          </div>
        </div>
        <h2 class="mt-3 font-semibold">고학년 (초5–6)</h2>
        <ul class="mt-2 text-sm text-slate-600 space-y-1">
          <li>조작: 수동 + 선택</li>
          <li>개념: 용어 일부</li>
          <li>실패: 조건 실패</li>
        </ul>
      </button>
    </section>

    <section class="rounded-2xl border bg-white p-4 shadow-sm space-y-4">
      <div class="flex items-center justify-between">
        <span class="font-medium">미션</span>
        <button id="missionBtn" class="px-4 py-2 rounded-xl border bg-white">OFF</button>
      </div>

      <div class="flex items-center justify-between">
        <span class="font-medium">시간</span>
        <div class="flex gap-2" id="timeGroup">
          <button data-time="5" class="time-btn px-3 py-2 rounded-xl border bg-white">5분</button>
          <button data-time="10" class="time-btn px-3 py-2 rounded-xl border bg-white">10분</button>
          <button data-time="15" class="time-btn px-3 py-2 rounded-xl border bg-white">15분</button>
        </div>
      </div>

      <div class="flex items-center justify-between">
        <span class="font-medium">사운드</span>
        <button id="soundBtn" class="px-4 py-2 rounded-xl border bg-white">ON</button>
      </div>

      <div class="flex items-center justify-between">
        <span class="font-medium">수업용 모드</span>
        <button id="classBtn" class="px-4 py-2 rounded-xl border bg-white">OFF</button>
      </div>

      <button id="startBtn" class="w-full py-4 rounded-2xl bg-black text-white text-lg font-semibold">
        시작하기
      </button>

      <p id="hint" class="text-sm text-slate-600">
        팁: 카드를 눌러 학년을 선택한 뒤 시작을 눌러요.
      </p>
    </section>
  </main>

<script>
  let state = { grade: "low", mission: 0, time: 10, sound: 1, classmode: 0 };

  const setSelectedCard = () => {
    document.querySelectorAll(".grade-card").forEach(btn => {
      const on = btn.dataset.grade === state.grade;
      btn.classList.toggle("ring-2", on);
      btn.classList.toggle("ring-black", on);
    });
  };

  document.getElementById("gradeCards").addEventListener("click", (e) => {
    const btn = e.target.closest(".grade-card");
    if (!btn) return;
    state.grade = btn.dataset.grade;
    setSelectedCard();
  });

  const toggleBtn = (id, key) => {
    const el = document.getElementById(id);
    el.addEventListener("click", () => {
      state[key] = state[key] ? 0 : 1;
      el.textContent = state[key] ? "ON" : "OFF";
      if (key === "classmode") {
        document.getElementById("hint").textContent = state.classmode
          ? "카드 선택 → 시작!"
          : "팁: 카드를 눌러 학년을 선택한 뒤 시작을 눌러요.";
      }
    });
  };

  toggleBtn("missionBtn", "mission");
  toggleBtn("soundBtn", "sound");
  toggleBtn("classBtn", "classmode");

  document.getElementById("timeGroup").addEventListener("click", (e) => {
    const btn = e.target.closest(".time-btn");
    if (!btn) return;
    state.time = Number(btn.dataset.time);
    document.querySelectorAll(".time-btn").forEach(b => {
      const on = Number(b.dataset.time) === state.time;
      b.classList.toggle("bg-black", on);
      b.classList.toggle("text-white", on);
      b.classList.toggle("border-black", on);
    });
  });

  document.getElementById("startBtn").addEventListener("click", () => {
    const qs = new URLSearchParams({
      grade: state.grade,
      mission: String(state.mission),
      time: String(state.time),
      sound: String(state.sound),
      classmode: String(state.classmode),
    });
    location.href = "./play.html?" + qs.toString();
  });

  // init
  setSelectedCard();
  document.querySelector('[data-time="10"]').click();
  document.getElementById("soundBtn").textContent = "ON";
  document.getElementById("missionBtn").textContent = "OFF";
  document.getElementById("classBtn").textContent = "OFF";
</script>
</body>
</html>
